# 系统模块

上述系统包括新冠抗原自【检试剂盒】、【数据上传前端模块】和【系统中心数据平台】，

- 所述自检试剂盒包括自检试剂和二维码，其中所述二维码用于认证试剂来源，该二维码中嵌入具有唯一性的抗原自检试剂盒序列号；
- 所述【上传前端模块】包括有摄像头和数据上传网络接口，摄像头用于拍摄试剂盒上二维码及试剂自检结果，并通过数据上传网络接口将数据上传至系统中心数据平台；

- 所述【系统中心数据平台】包含二维码分发模块和数据处理模块，其中二维码分发模块统一生成唯一的新冠抗原自检试剂盒序列号，该序列号由平台对抗原试剂生产厂家分配不同的序列编码，再由序列编码生成唯一的序列号，针对生成的序列号，平台选择相应的加密算法对序列号进行加密后分发至试剂生产厂家，抗原试剂生产厂家根据加密序列号生成二维码，将该二维码印刷在易碎纸上；
- 所述【系统中心数据平台】接收数据上传前端模块传来的二维码信息对试剂盒进行认证，在使用者完成抗原自检后接收数据上传前端模块采集的自检结果照片并对照片进行处理，获取自检结果。

# 需求解释

优先地，【新冠抗原自检试剂盒】的观测窗口与测试板密封有不干胶易碎纸，自检人员只有揭开易碎纸才能完成自检，所述二维码印刷在所述不干胶易碎纸上。
进一步，所述的【新冠抗原自检试剂盒】序列号具有唯一性与不可篡改性，该序列号的定义与生成方式如下所示：
**Encode (concat(prefix, random), key)**

（其中，Encode是加密算法，可由数据平台自主选择, key是平台使用的加密密钥，contact是字符串连接函数，**prefix是生产厂商的唯一标识**，不同的生产厂商标识不同, random是随机数，该自检抗原试剂序列号由系统中心数据平台统一生成、加密与分发，并由生产厂家编码嵌入到二维码后，印刷于试剂盒表面，作为试剂盒身份与试剂盒生产厂商的可信认证标志。）



进一步，数据上传前端模块采集自检结果包括如下步骤：首先扫描密封测试板的不干胶易碎纸，对检测试剂的来源进行验证，验证通过后，揭开不干胶易碎纸，进行新冠抗原自检测试；完成抗原自检后，揭开密封观测窗口的印刷有二维码的不干胶易碎纸，拍照采集抗原自检完成的试剂盒照片，并对检测照片以及数据生成完整性认证数据，生成的方式以及包括的数据如下所示：
**HASH<photo, timestamp, auth>**
（其中：HASH为哈希函数，photo, timestamp, auth分别为采集的照片、采集时间戳、用户个人身份信息，利用数字水印将完整性认证数据嵌入采集的照片中，并将数据上传至系统中心数据处理平台。
在本发明的系统中，所述数据处理模块的处理包括：接收用户通过前端模块上传的完成抗原自检的试剂盒照片数据，并负责校验上传用户身份、时间、照片数据的完整性校验；对照片中试剂盒检测的结果进行分析与判断；完成用户上传数据的存储；开放的接口功能，面向第三方提供开放的数据查询和数据分析接口。更进一步，所述数据处理模块的处理还包括：比较用户通过前端模块上传的完成抗原自检的试剂盒照片中的时间数据和验证检测试剂来源时的照片中的时间数据，如果比较得出的时间差超过系统内的预设时间，则判定检测结果上传超时。）



# 开发需求


1. 找一个MD5算法，加密一个字符串
2. 定义一张表，记录生产厂商，字段： ID, 厂名，厂前缀
3. 定义一张表，记录生产厂商所有的检测盒的序列号，字段：ID,  厂ID， 厂前缀和随机字符串（生产序列号），MD5结果

4. 生成二维码接口，可以将一个字符串，转成二维码，导出二维码的图片

5. 接收一个二维码字符串，从表中查找是否是合法的生产序列号

6. 水印嵌入算法，把一个字符 串嵌入到图片当中，同时也可以从一张图片取出嵌入的字符串

7. PYTHON接收上传图片接口
